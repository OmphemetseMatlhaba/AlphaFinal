{% extends 'base.html' %}
{% load static %}

{% block content %}

<div class="container mt-5">
    <div class="row">
        <div class="col-md-4">
            <div class="card sticky-top"> <img class="card-img-top" src="https://img.freepik.com/free-photo/tranquil-sunset-rural-vineyard-autumn-harvest-mountain-range-serene-landscape-generated-by-artificial-intelligence_25030-65022.jpg?t=st=1707436710~exp=1707440310~hmac=397e7a3640ea2af0a8eefe5847e3207446b99dd329b2b44b35736e0353bd4d30&w=996" alt="Card image cap">
                <div class="card-body little-profile text-center">
                    <div class="pro-img"><img src="{{ farmer.profile.profile_picture.url }}" alt="user"></div>
                    <h2 class="m-b-0">{{ farmer.first_name }} {{ farmer.last_name }}</h2>
                    {% if alpha_rating <= 30 %}
                        <h4><span class="badge badge-primary">Seedling Conversationalist</span></h4>
                    {% elif alpha_rating <= 50 %}
                        <h4><span class="badge badge-secondary">Cultivated Conversationalist</span></h4>
                    {% elif alpha_rating <= 70 %}
                        <h4><span class="badge badge-success">Harvested Conversationalist</span></h4>
                    {% elif alpha_rating <= 85 %}
                        <h4><span class="badge badge-danger">Bountiful Conversationalist</span></h4>
                    {% elif alpha_rating <= 100 %}
                        <h4><span class="badge badge-dark"><i class="bi bi-fire"></i>&nbsp; Alpha Conversationalist</span></h4>
                    {% endif %}
                    <div class="row text-center m-t-20">
                        <div class="col-lg-4 col-md-4 m-t-20">
                            <h3 class="m-b-0 font-light">{{ total_posts }} </h3><small>Posts</small>
                        </div>
                        <div class="col-lg-4 col-md-4 m-t-20">
                            <h3 class="m-b-0 font-light">{{ total_upvotes }}</h3><small>Total Upvotes</small>
                        </div>
                        <div class="col-lg-4 col-md-4 m-t-20">
                            <h3 class="m-b-0 font-light">{{ alpha_rating }}%</h3><small>User Rating</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card">
                <div class="col-md-12 text-center my-3">
                    <h2>Basic Info</h2>
                </div>
                <div class="row px-5">
                    <div class="col">
                        <p>First Name: <span class="float-right font-weight-bold">{{ farmer.first_name }}</span></p>
                        <p>Last Name: <span class="float-right font-weight-bold">{{ farmer.last_name }}</span></p>
                    </div>
                    <div class="col">
                        {% if farmer.profile_public == True %}
                            <p>Email: <span class="float-right font-weight-bold">{{ farmer.email }}</span></p>
                        {% else %}
                            <p>Email: <span class="float-right font-weight-bold text-muted">Hidden</span></p>
                        {% endif %}
                        <p>Date Joined: <span class="float-right font-weight-bold">{{ farmer.date_joined|date:"j F Y" }}</span></p>
                    </div>
                </div>
                <div class="col-md-12 text-center my-3">
                    <h2>Farm Info</h2>
                </div>
                {% if farmer.profile_public == True %}
                <div class="row px-5">
                    <p>Farm Name: <span class="float-right font-weight-bold">{{ farm_info.name }}</span></p>
                    <p>City: <span class="float-right font-weight-bold">{{ farmer.profile.city }}</span></p>
                    <p>Farm Industry: <span class="float-right font-weight-bold">{{ farm_info.industry }}</span></p>
                    <p>Farming Practices: <span class="float-right font-weight-bold">{{ farm_info.farming_practices }}</span></p>
                    <p>Province: <span class="float-right font-weight-bold">{{ farmer.profile.province }}</span></p>
                    <p>Farm Size: <span class="float-right font-weight-bold">{{ farm_info.size }} Acres</span></p>
                    <p>Crops Grown: <span class="float-right font-weight-bold">{{ farm_info.crops_grown }}</span></p>
                    <p>Farming Specialty: <span class="float-right font-weight-bold">{{ farm_info.farming_specialty }}</span></p>
                    <p>Certification: <span class="float-right font-weight-bold">{{ farm_info.certification }}</span></p>
                    <p>Farming Experience: <span class="float-right font-weight-bold">{{ farm_info.farming_experience }} years</span></p>
                </div>
                {% else %}
                <div class="container-xxl h-100">
                    <div class="container d-flex align-items-center justify-content-center text-center">
                        <div class="row">
                            <i class="bi bi-eye-slash display-1 text-primary"></i>
                            <h1 class="display-1">This profile is set to private</h1>
                            <h1 class="mb-4">We wish we could show you this area....</h1>
                            <p class="mb-4">But the owner of this profile doesn't want to.</p>
                        </div>
                    </div>
                </div>
                {% endif %}
            </div>
            <div class="card mt-3">
                <div class="col-md-12 text-center my-3">
                    <h2>Recent Posts</h2>
                </div>
                {% for post in latest_posts %}
                <div class="card mb-4 border-0">
                    <div class="box-header">
                        <div class="user-block">
                            <a href="{{ post.farmer.profile.profile_picture.url }}" data-lightbox="user_profile">
                                <img class="rounded-circle" src="{{ post.farmer.profile.profile_picture.url }}" alt="User Image">
                            </a>
                            <span class="username">{{ post.farmer.first_name }} {{ post.farmer.last_name }}.</span>
                            <span class="description">{{ post.created_at|date:"j F Y" }}</span>
                        </div>
                    </div>
                    <div class="card-body">
                        <h4>{{ post.title }} </h4>
                        {{ post.body|safe }}<br>
                        {% for tag in post.tags.all %}
                            <a href="{% url 'posts_by_tag' tag=tag %}" >#{{ tag.name }}</a>
                        {% endfor %}
                    </div>
                    <div class="card-footer d-flex flex-wrap justify-content-between bg-white align-items-center ms-auto">
                        <div class="text-right"> 
                            <button class="btn btn-outline-success" disabled><i class="bi bi-hand-thumbs-up"></i>&nbsp; {{ post.upvotes }}</button>
                            <button class="btn btn-outline-danger" disabled><i class="bi bi-hand-thumbs-down"></i>&nbsp; {{ post.downvotes }}</button>
                        </div>
                    </div>
                </div>
                {% endfor %}
                <div class="col-md-12 text-center my-2">
                    <h2>AlphaBadges &reg;</h2>
                </div>
                <table class="table table-borderless">
                    <thead>
                        <td>Badge</td>
                        <td>Name</td>
                        <td>Description</td>
                        <td>Date Acquired</td>
                    </thead>
                    <tbody>
                        {% for badge in badges %}
                        <tr>
                            <td>
                                <a href="{{ badge.achievement.image.url }}" data-lightbox="badges">
                                    <img src="{{ badge.achievement.image.url }}" alt="" class="rounded-circle" height="60px" data-lightbox="gallery">
                                </a>
                            </td>
                            <td class="align-middle">{{ badge.achievement.name }}</td>
                            <td class="align-middle">{{ badge.achievement.description }}</td>
                            <td class="align-middle">{{ badge.date_earned|date:"j F Y" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<style>
    .padding {
        padding: 3rem !important;
        margin-left: 200px
    }

    .card-img-top{
        height:300px;
    }

    .card-no-border .card {
        border-color: #d7dfe3;
        border-radius: 4px;
        margin-bottom: 30px;
        -webkit-box-shadow: 0px 5px 20px rgba(0, 0, 0, 0.05);
        box-shadow: 0px 5px 20px rgba(0, 0, 0, 0.05)
    }

    .card-body {
        -ms-flex: 1 1 auto;
        flex: 1 1 auto;
        padding: 1.25rem
    }

    .pro-img {
        margin-top: -80px;
        margin-bottom: 20px
    }

    .little-profile .pro-img img {
        width: 128px;
        height: 128px;
        -webkit-box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
        border-radius: 100%
    }

    html body .m-b-0 {
        margin-bottom: 0px
    }

    h3 {
        line-height: 30px;
        font-size: 21px
    }

    .btn-rounded.btn-md {
        padding: 12px 35px;
        font-size: 16px
    }

    html body .m-t-10 {
        margin-top: 10px
    }

    .btn-rounded {
        border-radius: 60px;
        padding: 7px 18px
    }

    .m-t-20 {
        margin-top: 20px
    }

    .box-header {
        color: #444;
        display: block;
        padding: 10px;
        position: relative;
    }
    .user-block img {
        width: 60px;
        height: 60px;
        float: left;
        margin-left: 10px;
    }
    .user-block .username {
        font-size: 16px;
        font-weight: 600;
    }
    .user-block .description {
        color: #999;
        font-size: 13px;
    }
    .user-block .username, 
    .user-block .description, 
    .user-block .comment {
        display: block;
        margin-left: 70px;
    }
    .box-header>.box-tools {
        position: absolute;
        right: 10px;
        top: 15px;
    }

    @media (max-width: 767px) {
        .box-tools {
            display: none;
        }
    }
    td{
        text-align: center;
        align-items: center;
        justify-content: center;
    }
</style>

{% endblock %}
