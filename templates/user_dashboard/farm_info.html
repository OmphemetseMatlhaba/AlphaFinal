{% extends 'base.html' %}
{% load static %}
{% block title %}Alpha | Farm Info{% endblock %}
{% block content %}

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0/dist/js/select2.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<div class="container mt-5">
    <div class="row">  
        {% include 'user_dashboard/dashboard_sidebar.html' %}
        <div class="col-lg-8 pb-5">
            {% include 'includes/alerts.html' %}
            <div class="col-md-12 text-center">
                <h4>Farm Information</h4>
            </div>
            <form action="{% url 'farm_info' %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.name }}
                                <label for="">Farm Name</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.location}}
                                <label for="">Farm Address</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.size }}
                                <label for="">Total Farm Size in Acres</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.industry }}
                                <label for="">Farming Industry</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.farming_practices }}
                                <label for="">Farming Practices Followed</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.crops_grown }}
                                <label for="">Crops Grown</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.livestock_grown }}
                                <label for="">Livestock Grown</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.farming_experience }}
                                <label for="">Farming experience in years</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.certification }}
                                <label for="">Farming Certification</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            <div class="form-floating mb-3">
                                {{ farm_info.farming_experience }}
                                <label for="">Farming experience in years</label>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="latitude" id="latitude" value="{{ current_lat }}">
                <input type="hidden" name="longitude" id="longitude" value="{{ current_lon }}">
                <div class="col-md-12 text-center"> 
                    <button type="submit" class="btn btn-secondary mx-auto" style="width: 20%;">Submit</button>
                </div>
            </form>
            <br>
            <div class="col-md-12 text-center">
                <h4>Your Farm Location </h4>
            </div>
            <img class="justify-content-center text-center" src="https://api.mapbox.com/styles/v1/mapbox/streets-v12/static/pin-l+0b411e({{ farmer.longitude }},{{ farmer.latitude }})/{{ farmer.longitude }},{{ farmer.latitude }},16,0/800x400?access_token=pk.eyJ1Ijoia2F0bGVnbzE1IiwiYSI6ImNsajRpNXhjZDAyN3kzaHFua3lkOG1tMTUifQ.J6lRzzL3d7caC9dSgWFP5w" alt="">
        </div>
    </div>
</div>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAbrH17xrTrz1QzXIbJIi47F4jX234p8QU&libraries=places&callback=initAutocomplete" async defer></script>
<script>
    function initAutocomplete() {
        var input = document.getElementById('address-input');
        var latitudeInput = document.getElementById('latitude');
        var longitudeInput = document.getElementById('longitude');

        var options = {
            types: ['address'], 
            componentRestrictions: { country: 'ZA' } 
        };
        var autocomplete = new google.maps.places.Autocomplete(input, options);

        
        input.addEventListener('input', function () {
            if (input.value.length >= 4) {
                autocomplete.setBounds(map.getBounds()); 
                autocomplete.getPlace();
            }
        });

        autocomplete.addListener('place_changed', function () {
            var place = autocomplete.getPlace();
            var lat = place.geometry.location.lat();
            var lng = place.geometry.location.lng();
            latitudeInput.value = lat;
            longitudeInput.value = lng;
        });
    }
</script>

<script>
    $(document).ready(function () {
        $('.js-select2').select2();
    });
</script>


{% endblock %}